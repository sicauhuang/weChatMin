<view class="car-detail-page">
  <!-- 加载状态 -->
  <view class="loading-overlay" wx:if="{{loading}}">
    <text class="loading-text">加载中...</text>
  </view>

  <!-- 页面内容 -->
  <scroll-view class="detail-container" scroll-y="true" enhanced="true" wx:if="{{vehicleData}}">
    <!-- 车辆图片轮播 -->
    <view class="detail-images">
      <swiper 
        class="images-swiper"
        indicator-dots="true"
        indicator-color="rgba(255,255,255,0.5)"
        indicator-active-color="#FF8C00"
        autoplay="false"
        circular="true"
        bindchange="onImageSwiperChange"
        bindtap="onImagePreview">
        <swiper-item wx:for="{{vehicleData.images}}" wx:key="index">
          <image 
            class="swiper-image" 
            src="{{item || '/assets/imgs/car-placeholder.jpg'}}" 
            mode="aspectFill" />
        </swiper-item>
      </swiper>
      
      <!-- 状态标签 -->
      <view class="detail-status detail-status--{{vehicleData.status}}">
        <text class="detail-status__text">
          {{vehicleData.status === 'ON_SALE' ? '在售中' : (vehicleData.status === 'RESERVED' ? '已预订' : (vehicleData.status === 'SOLD' ? '已售出' : '已下架'))}}
        </text>
      </view>

      <!-- 图片计数 -->
      <view class="image-counter" wx:if="{{vehicleData.images.length > 1}}">
        <text class="image-counter__text">{{currentImageIndex + 1}}/{{vehicleData.images.length}}</text>
      </view>
    </view>

    <!-- 基本信息卡片 -->
    <view class="detail-card">
      <view class="detail-card__header">
        <text class="detail-card__title">基本信息</text>
      </view>
      
      <view class="detail-card__content">
        <!-- 车型和价格 -->
        <view class="basic-info">
          <view class="basic-info__main">
            <text class="basic-info__model">{{vehicleData.carModel}}</text>
            <text class="basic-info__condition">{{vehicleData.condition}}</text>
          </view>
          <view class="basic-info__price">
            <text class="basic-info__price-text">{{vehicleData.price}}</text>
            <text class="basic-info__price-unit">万元</text>
          </view>
        </view>

        <!-- 详细信息 -->
        <view class="detail-info">
          <view class="detail-info__item">
            <view class="detail-info__label">
              <text class="iconfont icon-chepai detail-info__icon"></text>
              <text class="detail-info__label-text">车牌号</text>
            </view>
            <text class="detail-info__value">{{vehicleData.licensePlate}}</text>
          </view>
          
          <view class="detail-info__item">
            <view class="detail-info__label">
              <text class="iconfont icon-weizhi detail-info__icon"></text>
              <text class="detail-info__label-text">所在地区</text>
            </view>
            <text class="detail-info__value">{{vehicleData.location}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- 联系信息卡片 -->
    <view class="detail-card">
      <view class="detail-card__header">
        <text class="detail-card__title">联系信息</text>
      </view>
      
      <view class="detail-card__content">
        <view class="contact-info">
          <view class="contact-info__item">
            <view class="contact-info__label">
              <text class="iconfont icon-yonghu contact-info__icon"></text>
              <text class="contact-info__label-text">车主姓名</text>
            </view>
            <text class="contact-info__value">{{vehicleData.ownerName}}</text>
          </view>
          
          <view class="contact-info__item" bindtap="onCallPhone">
            <view class="contact-info__label">
              <text class="iconfont icon-dianhua contact-info__icon"></text>
              <text class="contact-info__label-text">联系电话</text>
            </view>
            <view class="contact-info__phone">
              <text class="contact-info__value">{{vehicleData.contactPhone}}</text>
              <text class="iconfont icon-dianhua contact-info__call-icon"></text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- 车辆描述卡片 -->
    <view class="detail-card" wx:if="{{vehicleData.description}}">
      <view class="detail-card__header">
        <text class="detail-card__title">车辆描述</text>
      </view>
      
      <view class="detail-card__content">
        <text class="description-text">{{vehicleData.description}}</text>
      </view>
    </view>

    <!-- 发布信息卡片 -->
    <view class="detail-card">
      <view class="detail-card__header">
        <text class="detail-card__title">发布信息</text>
      </view>
      
      <view class="detail-card__content">
        <view class="publish-info">
          <view class="publish-info__item">
            <text class="publish-info__label">发布时间</text>
            <text class="publish-info__value">{{vehicleData.createdAt}}</text>
          </view>
          <view class="publish-info__item">
            <text class="publish-info__label">更新时间</text>
            <text class="publish-info__value">{{vehicleData.updatedAt}}</text>
          </view>
        </view>
      </view>
    </view>

    <!-- 占位空间 -->
    <view class="detail-spacer"></view>
  </scroll-view>

  <!-- 底部操作按钮 -->
  <view class="detail-actions" wx:if="{{vehicleData}}">
    <button 
      class="detail-actions__button detail-actions__button--secondary"
      bindtap="onCallPhone">
      <text class="iconfont icon-dianhua detail-actions__button-icon"></text>
      联系车主
    </button>
    <button 
      class="detail-actions__button detail-actions__button--primary"
      bindtap="onShowActionSheet">
      <text class="iconfont icon-gengduo detail-actions__button-icon"></text>
      更多操作
    </button>
  </view>

  <!-- 操作菜单 -->
  <view class="action-sheet" wx:if="{{showActionSheet}}" bindtap="onHideActionSheet">
    <view class="action-sheet__mask"></view>
    <view class="action-sheet__content" catchtap="">
      <view class="action-sheet__header">
        <text class="action-sheet__title">车辆操作</text>
        <text class="iconfont icon-guanbi action-sheet__close" bindtap="onHideActionSheet"></text>
      </view>
      
      <view class="action-sheet__body">
        <view 
          class="action-sheet__item {{item.danger ? 'danger' : ''}}"
          wx:for="{{actionSheetItems}}"
          wx:key="key"
          data-key="{{item.key}}"
          bindtap="onActionSheetItemTap">
          <text class="iconfont {{item.icon}} action-sheet__item-icon"></text>
          <text class="action-sheet__item-text">{{item.text}}</text>
          <text class="iconfont icon-arrow-right action-sheet__item-arrow"></text>
        </view>
      </view>
    </view>
  </view>
</view>